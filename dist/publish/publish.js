!function i(o,s,l){function c(t,e){if(!s[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(u)return u(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var a=s[t]={exports:{}};o[t][0].call(a.exports,function(e){return c(o[t][1][e]||e)},a,a.exports,i,o,s,l)}return s[t].exports}for(var u="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BabylonLoader=void 0;var x=e("../lib"),n=(B.loadFromBabylonAsset=function(){},B.loadBabylon=function(e){var t,r=e.get("id"),n=null;B.babylonCacheData[r]?(n=B.babylonCacheData[r],B.parseBabylon(r,n),B.assembleBabylon(r,n)):(t={url:B.prefix+e.get("id")+"/"+e.get("name"),method:"GET",data:null,ignoreContentType:!0},new x.Ajax(t).on("load",function(e,t){n=t,B.babylonCacheData[r]=n,B.parseBabylon(r,n),B.assembleBabylon(r,n)}).on("error",function(e){console.error(e)}))},B.assembleBabylon=function(e,n){var t;if(null!==n){if(console.warn(n),console.log(n.meshes),console.log(n.materials),console.log(n.lights),B.assetsData.babylon[e]){var r,a,i=B.assetsData.babylon[e].materials,o=[];for(r in i){i[r].asset_id&&B.assetsData.assets[i[r].asset_id]&&((a=B.assetsData.assets[i[r].asset_id].data).diffuseTexture&&a.diffuseTexture.texture_id&&(a.diffuseTexture.name=B.prefix+a.diffuseTexture.texture_id+"/"+B.assetsData.assets[a.diffuseTexture.texture_id].name),a.specularTexture&&a.specularTexture.texture_id&&(a.specularTexture.name=B.prefix+a.specularTexture.texture_id+"/"+B.assetsData.assets[a.specularTexture.texture_id].name),a.reflectionTexture&&a.reflectionTexture.texture_id&&(a.reflectionTexture.name=B.prefix+a.reflectionTexture.texture_id+"/"+B.assetsData.assets[a.reflectionTexture.texture_id].name),a.refractionTexture&&a.refractionTexture.texture_id&&(a.refractionTexture.name=B.prefix+a.refractionTexture.texture_id+"/"+B.assetsData.assets[a.refractionTexture.texture_id].name),a.emissiveTexture&&a.emissiveTexture.texture_id&&(a.emissiveTexture.name=B.prefix+a.emissiveTexture.texture_id+"/"+B.assetsData.assets[a.emissiveTexture.texture_id].name),a.bumpTexture&&a.bumpTexture.texture_id&&(a.bumpTexture.name=B.prefix+a.bumpTexture.texture_id+"/"+B.assetsData.assets[a.bumpTexture.texture_id].name),a.opacityTexture&&a.opacityTexture.texture_id&&(a.opacityTexture.name=B.prefix+a.opacityTexture.texture_id+"/"+B.assetsData.assets[a.opacityTexture.texture_id].name),a.ambientTexture&&a.ambientTexture.texture_id&&(a.ambientTexture.name=B.prefix+a.ambientTexture.texture_id+"/"+B.assetsData.assets[a.ambientTexture.texture_id].name),a.lightmapTexture&&a.lightmapTexture.texture_id&&(a.lightmapTexture.name=B.prefix+a.lightmapTexture.texture_id+"/"+B.assetsData.assets[a.lightmapTexture.texture_id].name),o.push(a))}o.forEach(function(e){B.loadMaterial(e,VR.BabylonEngine.Scene,"")})}n.geometries&&n.geometries.vertexData&&n.geometries.vertexData.array.forEach(function(e){B.loadGeometry(e,VR.BabylonEngine.Scene,"")});var s=[];n.transformNodes&&n.transformNodes.forEach(function(e){var t=B.loadTransformNode(e,VR.BabylonEngine.Scene,"");s.push(t)});var l=[],c=[],u={},h={};n.meshes&&(n.meshes.forEach(function(e){var t,r;B.scenesData.entities[e.id]?(t=x.GUID.create(),r=e.id,h[t]=r,e.id=t,n.meshes.forEach(function(e){e.parentId===r&&(e.parentId=t,console.log("change parent id"))})):h[e.id]=e.id}),n.meshes.forEach(function(e){var t=B.loadMesh(e,VR.BabylonEngine.Scene,"");l.push(t),u[e.id]=t}));var d=null,p=null;"entity"===editor.call("selector:type")&&(d=editor.call("selector:items")[0]),d?d.node&&(p=d.node):d=editor.call("entities:root");for(var g=[],f=[],m=0,y=s.length;m<y;m++){var _=s[m];_&&_._waitingParentId&&(_.parent=VR.BabylonEngine.Scene.getLastEntryByID(_._waitingParentId),_._waitingParentId=null)}for(var b=0,v=l.length;b<v;b++)null!==l[b]&&(l[b]._waitingParentId&&u[l[b]._waitingParentId]?l[b].parent=u[l[b]._waitingParentId]:(l[b].parent=p,c.push(l[b])),l[b]._waitingParentId=null);for(b=0;b<c.length;b++)B.meshParseRecursion(c[b],e,h,g,f);editor.call("selector:history",!1),editor.call("selector:set","entity",[editor.call("entities:get",null===(t=c[0])||void 0===t?void 0:t.id)]),editor.once("selector:change",function(){editor.call("selector:history",!0)}),editor.call("make:scene:dirty")}},B.parseBabylon=function(e,t){var r;t&&(r={},t.materials&&(r.materials={},t.materials.forEach(function(e){r.materials[e.id]=e})),t.geometries&&t.geometries.vertexData&&(r.geometries={},t.geometries.vertexData.forEach(function(e){r.geometries[e.id]=e})),t.meshes&&(r.meshes={},t.meshes.forEach(function(e){r.meshes[e.id]=e})),t.transformNodes&&(r.transformNodes={},t.transformNodes.forEach(function(e){r.transformNodes[e.id]=e})),B.babylonParsedData[e]=r)},B.hasBabylobData=function(e){return e in B.babylonCacheData},B.getBabylonData=function(e){return e in B.babylonCacheData?B.babylonCacheData[e]:null},B.hasParsedBabylonData=function(e){return e in B.babylonParsedData},B.getParsedBabylonData=function(e){return e in B.babylonParsedData?B.babylonParsedData[e]:null},B.meshParseRecursion=function(e,t,r,n,a){if(e){var i="";i=null!==e.parent?e.parent.id:editor.call("entities:root").get("resource_id");for(var o=e.getChildren(),s=[],l=0;l<o.length;l++)s.push(o[l].id);var c=x.Tools.radianToEulerAngle(e.rotation),u={name:e.name,resource_id:e.id,babylon_id:r[e.id],asset_id:t,parent:i,position:[e.position.x,e.position.y,e.position.z],rotation:[c.x,c.y,c.z],scale:[e.scaling.x,e.scaling.y,e.scaling.z],children:s,enabled:e.isEnabled(),checkCollisions:e.checkCollisions,pickable:e.isPickable,isVisible:e.isVisible,tags:[],type:"mesh"},h=editor.call("entities:new",u);n.push(h),a.push(h.origin);for(l=0;l<o.length;l++)B.meshParseRecursion(o[l],t,r,n,a)}},B.addSceneData=function(e,t){B.scenesData.entities[e]=t,B.scenesData.modified=B.createdAtTime()},B.updateSceneData=function(e,t){B.scenesData.entities[e]=t,B.scenesData.modified=B.createdAtTime()},B.createdAtTime=function(){var e=new Date;return e.getFullYear()+"-"+B.getRealTime(e.getMonth()+1)+"-"+B.getRealTime(e.getDate())+" "+B.getRealTime(e.getHours())+":"+B.getRealTime(e.getMinutes())},B.getRealTime=function(e){return e<10?"0"+e:e.toString()},B.createCameraWraper=function(e,t,r){var n=new BABYLON.UniversalCamera(e,new BABYLON.Vector3(0,100,-200),t);n.maxZ=2e4,n.attachControl(r,!0);var a=new x.VeryCamera(n,t,r);return a.orthoSize=.5,a},B.createLightWraper=function(e,t,r){var n=B.createLight(e,t,r);return new x.VeryLight(n,r)},B.createLight=function(e,t,r){return"point"===(e=e.toLowerCase())?new BABYLON.PointLight(t,BABYLON.Vector3.Zero(),r):"spot"===e?new BABYLON.SpotLight(t,BABYLON.Vector3.Zero(),new BABYLON.Vector3(0,-1,0),.75*Math.PI,8,r):"hemispheric"===e?new BABYLON.HemisphericLight(t,BABYLON.Vector3.Up(),r):new BABYLON.DirectionalLight(t,BABYLON.Vector3.Forward(),r)},B.loadLight=function(e,t){return null==e?null:BABYLON.Light.Parse(e,t)},B.loadReflectionProbe=function(e,t,r){return null==e?null:BABYLON.ReflectionProbe.Parse(e,t,r)},B.loadAnimation=function(e){if(null==e)return null;var t=BABYLON._TypeStore.GetClass("BABYLON.Animation");return t?t.Parse(e):null},B.loadMaterial=function(e,t,r){return null==e?null:BABYLON.Material.Parse(e,t,r)},B.loadMultiMaterial=function(e,t){return null==e?null:BABYLON.MultiMaterial.ParseMultiMaterial(e,t)},B.loadMorphTargetManager=function(e,t){return null==e?null:BABYLON.MorphTargetManager.Parse(e,t)},B.loadSkeleton=function(e,t){return null==e?null:BABYLON.Skeleton.Parse(e,t)},B.loadGeometry=function(e,t,r){return null==e?null:BABYLON.Geometry.Parse(e,t,r)},B.loadTransformNode=function(e,t,r){return null==e?null:BABYLON.TransformNode.Parse(e,t,r)},B.loadMesh=function(e,t,r){return null==e?null:BABYLON.Mesh.Parse(e,t,r)},B.loadCamera=function(e,t){return null==e?null:BABYLON.Camera.Parse(e,t)},B.loadAnimationGroup=function(e,t){return null==e?null:BABYLON.AnimationGroup.Parse(e,t)},B.setBabylonParent=function(e){for(var t,r=0,n=0,a=e.cameras.length;n<a;n++){var i=e.cameras[n];i._waitingParentId&&(i.parent=e.getLastEntryByID(i._waitingParentId),i._waitingParentId=null)}for(t=0,r=e.lights.length;t<r;t++){var o=e.lights[t];o&&o._waitingParentId&&(o.parent=e.getLastEntryByID(o._waitingParentId),o._waitingParentId=null)}for(t=0,r=e.transformNodes.length;t<r;t++){var s=e.transformNodes[t];s._waitingParentId&&(s.parent=e.getLastEntryByID(s._waitingParentId),s._waitingParentId=null)}for(t=0,r=e.meshes.length;t<r;t++){var l=e.meshes[t];l._waitingParentId&&(l.parent=e.getLastEntryByID(l._waitingParentId),l._waitingParentId=null)}},B.prefix="/assets/",B.assetsData={},B.projectData={},B.scenesData={},B.sceneIndex=0,B.babylonCacheData={},B.babylonParsedData={},B);function B(){}r.BabylonLoader=n},{"../lib":12}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Config=void 0;var n=(a.addCamera=function(e){a.cameras.push(e)},a.prefix="/assets/",a.projectID="",a.projectName="",a.projectData={},a.userID="",a.username="",a.assetsData={},a.scenesData={},a.sceneIndex=0,a.sceneName="",a.tableAssetsID="",a.tableName="",a.tableData=null,a.cameras=[],a);function a(){}r.Config=n},{}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Game=void 0;var n=e("./config"),a=e("./loader"),i=(o.prototype.createScene=function(e){var t=this;this._engine&&(VR.VE_Manager.dispose(),this._engine.dispose()),this._engine=new BABYLON.Engine(this._canvas,!0),VR.BabylonEngine.Engine=this._engine;var r=this._engine;return window.addEventListener("resize",function(){r.resize()}),this._scene=new BABYLON.Scene(this._engine),VR.BabylonEngine.Scene=this._scene,VR.Time.start(),this._scene.clearColor=new BABYLON.Color4(116/255,116/255,116/255,1),r.displayLoadingUI(),editor.call("scene:raw",n.Config.scenesData),this.startVeryEngine(this._scene,e),r.hideLoadingUI(),this._scene.onKeyboardObservable.add(function(e){e.type===BABYLON.KeyboardEventTypes.KEYDOWN&&81===e.event.keyCode&&e.event.ctrlKey&&e.event.altKey&&(console.log("Ctrl + Alt + Q"),t.toggleDebug())}),this._engine.runRenderLoop(function(){t._scene&&t._scene.activeCamera&&t._scene.render()}),this},o.prototype.startVeryEngine=function(e,t){var r=new VR.VeryEngine;try{r.init(t,"测试项目")}catch(e){console.error(e)}var n=VR.VE_Manager.objects("测试项目");e.onBeforeRenderObservable.add(function(){for(var e=0;e<n.count;e++){var t=n.getObjectID(e);n.getVeryObject(t).update()}})},o.prototype.animate=function(){var r=this;return this._engine.runRenderLoop(function(){if(r._canvas.width!==r._canvas.clientWidth&&r._engine.resize(),r._scene){for(var e=0,t=n.Config.cameras.length;e<t;e++)n.Config.cameras[e].resize(!1);r._scene.render()}r._showFps&&r.updateFpsPos()}),this},o.prototype.toggleDebug=function(){var e;return this._engine&&((e=this._engine.scenes[0]).debugLayer.isVisible()?e.debugLayer.hide():e.debugLayer.show({embedMode:!0})),this},o.prototype.updateFpsPos=function(){this._fps&&(this._fps.innerHTML=this._engine.getFps().toFixed()+" fps")},o);function o(e,t){this._showFps=!0,new a.Loader,this._canvas=e,VR.BabylonEngine.Canvas=this._canvas,this._fps=t,this._table=document.getElementById("VeryTable")}r.Game=i},{"./config":2,"./loader":5}],4:[function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),a(e("./game"),r),a(e("./scenes"),r),a(e("./config"),r),a(e("./loader"),r),a(e("./babylonloader"),r)},{"./babylonloader":1,"./config":2,"./game":3,"./loader":5,"./scenes":6}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Loader=void 0;function n(){editor.method("initAssets",function(e){e.assets&&t(e.assets)});var t=function(e){editor.call("assets:progress",.5);var t,r,n=0,a=Object.getOwnPropertyNames(e).length;for(t in e)r=e[t],editor.call("loadAsset",r,function(){n++,editor.call("assets:progress",n/a*.5+.5),a<=n&&(editor.call("assets:progress",1),editor.emit("assets:load"))})};editor.method("scene:raw",function(e){for(var t in e.entities){var r=new p.Observer(e.entities[t]);"root"!==r.get("type")&&editor.call("create:scene:element",r)}editor.emit("entities:load")});var i={},h={};editor.method("create:scene:element",function(e){var t,r,n,a,i;"light"===e.get("type")?((t=g.BabylonLoader.createLightWraper(e.get("subtype"),e.get("name"),VR.BabylonEngine.Scene)).light.intensity=e.has("intensity")?e.get("intensity"):1,e.has("diffuse")&&3===e.get("diffuse").length&&(t.light.diffuse=BABYLON.Color3.FromArray(e.get("diffuse"))),e.has("specular")&&3===e.get("specular").length&&(t.light.specular=BABYLON.Color3.FromArray(e.get("specular"))),t.light instanceof BABYLON.SpotLight&&(e.has("angle")&&(t.light.angle=e.get("angle")),e.has("exponent")&&(t.light.exponent=e.get("exponent"))),t.id=e.get("resource_id"),h[e.get("resource_id")]=t,e.node=t,e.has("enabled")&&t.setEnabled(e.get("enabled")),e.has("position")&&3===e.get("position").length&&(t.position=BABYLON.Vector3.FromArray(e.get("position"))),e.has("rotation")&&3===e.get("rotation").length&&(t.rotation=p.Tools.eulerAngleToRadian(BABYLON.Vector3.FromArray(e.get("rotation"))),t.type===BABYLON.Light.LIGHTTYPEID_HEMISPHERICLIGHT&&t.light.direction.copyFrom(t.up)),e.has("scale")&&3===e.get("scale").length&&(t.scaling=BABYLON.Vector3.FromArray(e.get("scale"))),d(e,t)):"camera"===e.get("type")?(r=g.BabylonLoader.createCameraWraper(e.get("name"),VR.BabylonEngine.Scene,VR.BabylonEngine.Canvas),VR.BabylonEngine.Scene.activeCameras.push(r.camera),r.id=e.get("resource_id"),h[e.get("resource_id")]=r,e.node=r,e.has("enabled")&&r.setEnabled(e.get("enabled")),e.has("position")&&3===e.get("position").length&&(r.position=BABYLON.Vector3.FromArray(e.get("position"))),e.has("rotation")&&3===e.get("rotation").length&&(r.rotation=p.Tools.eulerAngleToRadian(BABYLON.Vector3.FromArray(e.get("rotation")))),e.has("scale")&&3===e.get("scale").length&&(r.scaling=BABYLON.Vector3.FromArray(e.get("scale"))),e.has("checkCollisions")&&r.camera instanceof BABYLON.FreeCamera&&(r.camera.checkCollisions=e.get("checkCollisions")),e.has("applyGravity")&&r.camera instanceof BABYLON.FreeCamera&&(r.camera.applyGravity=e.get("applyGravity")),e.has("viewport")&&(n=e.get("viewport"))&&n.length&&4===n.length&&(r.camera.viewport=new BABYLON.Viewport(n[0],n[1],n[2],n[3])),e.has("clearColor")?(n=e.get("clearColor"))&&n.length&&4===n.length&&(r.clearColor=new BABYLON.Color4(n[0],n[1],n[2],n[3])):r.clearColor=new BABYLON.Color4(45/255,145/255,186/255,1),e.has("mode")&&(r.mode=e.get("mode")),e.has("fov")&&(r.fov=e.get("fov")),e.has("inertia")&&(r.inertia=e.get("inertia")),e.has("orthoSize")&&(r.orthoSize=e.get("orthoSize")),r.resize(!1),c.Config.addCamera(r),d(e,r)):"empty"===e.get("type")?(a=new BABYLON.TransformNode(e.get("name"),VR.BabylonEngine.Scene),(e.node=a).id=e.get("resource_id"),a.position=BABYLON.Vector3.FromArray(e.get("position")),a.rotation=p.Tools.eulerAngleToRadian(BABYLON.Vector3.FromArray(e.get("rotation"))),a.scaling=BABYLON.Vector3.FromArray(e.get("scale")),a.isEnabled(e.get("enabled")),d(e,a)):"primitive"===e.get("type")?e.get("subtype")&&"box"===e.get("subtype")?(i=BABYLON.MeshBuilder.CreateBox(e.get("name"),{size:100},VR.BabylonEngine.Scene),e.node=i,(h[e.get("resource_id")]=i).id=e.get("resource_id"),e.has("enabled")&&i.setEnabled(e.get("enabled")),e.has("position")&&3===e.get("position").length&&(i.position=BABYLON.Vector3.FromArray(e.get("position"))),e.has("rotation")&&3===e.get("rotation").length&&(i.rotation=p.Tools.eulerAngleToRadian(BABYLON.Vector3.FromArray(e.get("rotation")))),e.has("scale")&&3===e.get("scale").length&&(i.scaling=BABYLON.Vector3.FromArray(e.get("scale"))),e.has("checkCollisions")&&(i.checkCollisions=e.get("checkCollisions")),e.has("pickable")&&(i.isPickable=e.get("pickable")),e.has("isVisible")&&(i.isVisible=e.get("isVisible")),e.get("material_id"),d(e,i)):e.get("subtype")&&"sphere"===e.get("subtype")?(i=BABYLON.MeshBuilder.CreateSphere(e.get("name"),{segments:20,diameter:100},VR.BabylonEngine.Scene),e.node=i,(h[e.get("resource_id")]=i).id=e.get("resource_id"),e.has("enabled")&&i.setEnabled(e.get("enabled")),e.has("position")&&3===e.get("position").length&&(i.position=BABYLON.Vector3.FromArray(e.get("position"))),e.has("rotation")&&3===e.get("rotation").length&&(i.rotation=p.Tools.eulerAngleToRadian(BABYLON.Vector3.FromArray(e.get("rotation")))),e.has("scale")&&3===e.get("scale").length&&(i.scaling=BABYLON.Vector3.FromArray(e.get("scale"))),e.has("checkCollisions")&&(i.checkCollisions=e.get("checkCollisions")),e.has("pickable")&&(i.isPickable=e.get("pickable")),e.has("isVisible")&&(i.isVisible=e.get("isVisible")),e.get("material_id"),d(e,i)):e.get("subtype")&&"plane"===e.get("subtype")?(i=BABYLON.MeshBuilder.CreateGround(e.get("name"),{width:5e3,height:5e3,subdivisions:10},VR.BabylonEngine.Scene),e.node=i,(h[e.get("resource_id")]=i).id=e.get("resource_id"),e.has("enabled")&&i.setEnabled(e.get("enabled")),e.has("position")&&3===e.get("position").length&&(i.position=BABYLON.Vector3.FromArray(e.get("position"))),e.has("rotation")&&3===e.get("rotation").length&&(i.rotation=p.Tools.eulerAngleToRadian(BABYLON.Vector3.FromArray(e.get("rotation")))),e.has("scale")&&3===e.get("scale").length&&(i.scaling=BABYLON.Vector3.FromArray(e.get("scale"))),e.has("checkCollisions")&&(i.checkCollisions=e.get("checkCollisions")),e.has("pickable")&&(i.isPickable=e.get("pickable")),e.has("isVisible")&&(i.isVisible=e.get("isVisible")),e.get("material_id"),d(e,i)):e.get("subtype")&&"cylinder"===e.get("subtype")&&(i=BABYLON.MeshBuilder.CreateCylinder(e.get("name"),{height:200,diameter:100},VR.BabylonEngine.Scene),e.node=i,(h[e.get("resource_id")]=i).id=e.get("resource_id"),e.has("enabled")&&i.setEnabled(e.get("enabled")),e.has("position")&&3===e.get("position").length&&(i.position=BABYLON.Vector3.FromArray(e.get("position"))),e.has("rotation")&&3===e.get("rotation").length&&(i.rotation=p.Tools.eulerAngleToRadian(BABYLON.Vector3.FromArray(e.get("rotation")))),e.has("scale")&&3===e.get("scale").length&&(i.scaling=BABYLON.Vector3.FromArray(e.get("scale"))),e.has("checkCollisions")&&(i.checkCollisions=e.get("checkCollisions")),e.has("pickable")&&(i.isPickable=e.get("pickable")),e.has("isVisible")&&(i.isVisible=e.get("isVisible")),e.get("material_id"),d(e,i)):"mesh"===e.get("type")&&editor.call("scene:mesh:create",e)});var d=function(e,t){for(var r,n=e.get("children"),a=0;a<n.length;a++)i[n[a]]={index:a,parent:t},h[n[a]]&&o(t,h[n[a]],a);!e.get("parent")||(r=i[e.get("resource_id")])&&r.parent&&o(r.parent,t,r.index)},o=function(e,t,r){null!==t&&(t.parent=e)};editor.method("scene:mesh:create",function(e){r(e)});var a={},s={},r=function(e){var t,r=e.get("asset_id"),n=null;g.BabylonLoader.hasBabylobData(r)?(n=g.BabylonLoader.getParsedBabylonData(r),l(e,n)):r in a?s[r].push(e):(a[r]=!0,s[r]=[e],t={url:g.BabylonLoader.prefix+r+"/"+g.BabylonLoader.assetsData.assets[r].name,method:"GET",data:null,ignoreContentType:!0},new p.Ajax(t).on("load",function(e,t){n=t,g.BabylonLoader.babylonCacheData[r]=n,g.BabylonLoader.parseBabylon(r,t),g.BabylonLoader.parseBabylon(r,t),n=g.BabylonLoader.getParsedBabylonData(r),s[r].forEach(function(e){l(e,n)})}).on("error",function(e){console.error("scene数据匹配babylon mesh数据错误！"),console.error(e)}))},l=function(e,t){var r,n,a,i,o,s,l,c,u;t&&(r=e.get("asset_id"),n=e.get("babylon_id"),t.meshes[n]?((a=t.meshes[n]).position=e.has("position")&&e.get("position")?e.get("position"):a.position,c=(c=e.get("rotation"))&&0<c.length?p.Tools.vector3ToArray(p.Tools.eulerAngleToRadian(BABYLON.Vector3.FromArray(c))):a.rotation,a.rotation=c,a.scale=e.has("scale")&&e.get("scale")?e.get("scale"):a.scal,a.name=e.has("name")&&e.get("name")?e.get("name"):a.name,a.id=e.has("resource_id")&&e.get("resource_id")?e.get("resource_id"):a.id,a.isEnabled=e.has("enabled")?e.get("enabled"):a.isEnabled,a.isVisible=e.has("isVisible")?e.get("isVisible"):a.isVisible,a.pickable=e.has("pickable")?e.get("pickable"):a.pickable,a.checkCollisions=e.has("checkCollisions")?e.get("checkCollisions"):a.checkCollisions,a.materialId=e.has("material_id")?e.get("material_id"):a.materialId,a.parentId=e.has("parent")?e.get("parent"):a.parentId,a.geometryId&&null===VR.BabylonEngine.Scene.getGeometryByID(a.geometryId)&&t.geometries&&t.geometries[a.geometryId]&&(i=t.geometries[a.geometryId],g.BabylonLoader.loadGeometry(i,VR.BabylonEngine.Scene,"")),a.materialId&&null===VR.BabylonEngine.Scene.getMaterialByID(a.materialId)&&(g.BabylonLoader.assetsData.babylon[r]?(o=g.BabylonLoader.assetsData.babylon[r].materials)&&o[a.materialId]&&(s=o[a.materialId].asset_id,g.BabylonLoader.assetsData.assets[s]?((l=g.BabylonLoader.assetsData.assets[s].data).diffuseTexture&&l.diffuseTexture.texture_id&&(l.diffuseTexture.name=g.BabylonLoader.prefix+l.diffuseTexture.texture_id+"/"+g.BabylonLoader.assetsData.assets[l.diffuseTexture.texture_id].name),l.specularTexture&&l.specularTexture.texture_id&&(l.specularTexture.name=g.BabylonLoader.prefix+l.specularTexture.texture_id+"/"+g.BabylonLoader.assetsData.assets[l.specularTexture.texture_id].name),l.reflectionTexture&&l.reflectionTexture.texture_id&&(l.reflectionTexture.name=g.BabylonLoader.prefix+l.reflectionTexture.texture_id+"/"+g.BabylonLoader.assetsData.assets[l.reflectionTexture.texture_id].name),l.refractionTexture&&l.refractionTexture.texture_id&&(l.refractionTexture.name=g.BabylonLoader.prefix+l.refractionTexture.texture_id+"/"+g.BabylonLoader.assetsData.assets[l.refractionTexture.texture_id].name),l.emissiveTexture&&l.emissiveTexture.texture_id&&(l.emissiveTexture.name=g.BabylonLoader.prefix+l.emissiveTexture.texture_id+"/"+g.BabylonLoader.assetsData.assets[l.emissiveTexture.texture_id].name),l.bumpTexture&&l.bumpTexture.texture_id&&(l.bumpTexture.name=g.BabylonLoader.prefix+l.bumpTexture.texture_id+"/"+g.BabylonLoader.assetsData.assets[l.bumpTexture.texture_id].name),l.opacityTexture&&l.opacityTexture.texture_id&&(l.opacityTexture.name=g.BabylonLoader.prefix+l.opacityTexture.texture_id+"/"+g.BabylonLoader.assetsData.assets[l.opacityTexture.texture_id].name),l.ambientTexture&&l.ambientTexture.texture_id&&(l.ambientTexture.name=g.BabylonLoader.prefix+l.ambientTexture.texture_id+"/"+g.BabylonLoader.assetsData.assets[l.ambientTexture.texture_id].name),l.lightmapTexture&&l.lightmapTexture.texture_id&&(l.lightmapTexture.name=g.BabylonLoader.prefix+l.lightmapTexture.texture_id+"/"+g.BabylonLoader.assetsData.assets[l.lightmapTexture.texture_id].name),g.BabylonLoader.loadMaterial(l,VR.BabylonEngine.Scene,"")):console.warn("scene mesh warn")):console.warn("scene mesh warn")),u=g.BabylonLoader.loadMesh(a,VR.BabylonEngine.Scene,""),e.node=u,h[e.get("resource_id")]=u,d(e,u)):console.warn("scene mesh warn"))}}var p=e("../lib"),g=e("./babylonloader"),c=e("./config");r.Loader=n},{"../lib":12,"./babylonloader":1,"./config":2}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Scenes=void 0;function n(){}r.Scenes=n},{}],7:[function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),a(e("./lib"),r),a(e("./game"),r)},{"./game":4,"./lib":12}],8:[function(e,t,r){"use strict";var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.AjaxRequest=r.Ajax=void 0;var i=e("../lib"),l=(o.get=function(e){return new s({url:e})},o.post=function(e,t){return new s({method:"POST",url:e,data:t})},o.put=function(e,t){return new s({method:"PUT",url:e,data:t})},o.delete=function(e){return new s({method:"DELETE",url:e})},o.param=function(e,t){o.params[e]=t},o.params={},o);function o(e){return"string"==typeof e&&(e={url:e}),new s(e)}r.Ajax=l;var c,s=(c=i.Events,a(u,c),u.prototype._onLoad=function(){if(this._progress=1,this.emit("progress",1),200===this._xhr.status||201===this._xhr.status)if(this.notJson)this.emit("load",this._xhr.status,this._xhr.responseText);else{try{var e=JSON.parse(this._xhr.responseText)}catch(e){return void this.emit("error",this._xhr.status||0,new Error("invalid json"))}this.emit("load",this._xhr.status,e)}else try{var t=(e=JSON.parse(this._xhr.responseText)).message;t=(t=t||(e.error||e.response&&e.response.error))||this._xhr.responseText,this.emit("error",this._xhr.status,t)}catch(e){this.emit("error",this._xhr.status)}},u.prototype._onError=function(e){this.emit("error",0,e)},u.prototype._onAbort=function(e){this.emit("error",0,e)},u.prototype._onProgress=function(e){var t;!e.lengthComputable||(t=e.loaded/e.total)!==this._progress&&(this._progress=t,this.emit("progress",this._progress))},u.prototype.abort=function(){this._xhr.abort()},u);function u(e){var t=c.call(this)||this;if(t._progress=0,!e)throw new Error("ajax请求无参数，请检查！");t._progress=0,t.emit("progress",t._progress),t._xhr=new XMLHttpRequest,e.cookies&&(t._xhr.withCredentials=!0),t._xhr.addEventListener("load",t._onLoad.bind(t),!1),t._xhr.upload.addEventListener("progress",t._onProgress.bind(t),!1),t._xhr.addEventListener("error",t._onError.bind(t),!1),t._xhr.addEventListener("abort",t._onAbort.bind(t),!1);var r=e.url;if(e.query&&Object.keys(e.query).length){-1===r.indexOf("?")&&(r+="?");var n=[];for(s in e.query)n.push(s+"="+e.query[s]);r+=n.join("&")}var a=r.split("{{");if(1<a.length){for(var i=1;i<a.length;i++){var o=a[i].indexOf("}}"),s=a[i].slice(0,o);void 0!==l.params[s]&&(a[i]=l.params[s]+a[i].slice(o+2))}r=a.join("")}if(t._xhr.open(e.method||"GET",r,!0),t.notJson=e.notJson||!1,e.ignoreContentType||"PUT"!==e.method&&"POST"!==e.method&&"DELETE"!==e.method||t._xhr.setRequestHeader("Content-Type","application/json"),e.headers)for(var s in e.headers)t._xhr.setRequestHeader(s,e.headers[s]);return!e.data||"string"==typeof e.data||e.data instanceof FormData||(e.data=JSON.stringify(e.data)),t._xhr.send(e.data||null),t}r.AjaxRequest=s},{"../lib":12}],9:[function(e,t,r){"use strict";var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.Editor=void 0;var i,o=e("./events"),s=(i=o.Events,a(l,i),l.prototype.method=function(e,t){if(void 0!==this._hooks[e])throw new Error("can't override hook: "+e);this._hooks[e]=t},l.prototype.methodRemove=function(e){delete this._hooks[e]},l.prototype.call=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(this._hooks[t]){e=Array.prototype.slice.call(arguments,1);try{return this._hooks[t].apply(null,e)}catch(e){console.error("%c%s %c(editor.method error)","color: #06f",t,"color: #f00"),console.error(e.stack)}}return null},l);function l(){var e=i.call(this)||this;return e._hooks={},e}r.Editor=s},{"./events":10}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.EventHandle=r.Events=void 0;var n=(Object.defineProperty(a.prototype,"suspendEvents",{get:function(){return this._suspendEvents},set:function(e){this._suspendEvents=e},enumerable:!1,configurable:!0}),a.prototype.on=function(e,t){var r=this._events[e];return void 0===r?this._events[e]=[t]:-1==r.indexOf(t)&&r.push(t),new i(this,e,t)},a.prototype.once=function(e,l){var c=this,u=this.on(e,function(e,t,r,n,a,i,o,s){l.call(c,e,t,r,n,a,i,o,s),u.unbind()});return u},a.prototype.emit=function(t,e,r,n,a,i,o,s,l){if(this._suspendEvents)return this;var c=this._events[t];if(!c)return this;c=c.slice(0);for(var u=0;u<c.length;u++)if(c[u])try{c[u].call(this,e,r,n,a,i,o,s,l)}catch(e){console.info("%c%s %c(event error)","color: #06f",t,"color: #f00"),console.log(e.stack)}return this},a.prototype.unbind=function(e,t){if(e){var r,n=this._events[e];if(!n)return this;t?-1!==(r=n.indexOf(t))&&(1===n.length?delete this._events[e]:n.splice(r,1)):delete this._events[e]}else this._events={};return this},a);function a(){this._suspendEvents=!1,this._events={}}r.Events=n;var i=(o.prototype.unbind=function(){this.owner&&(this.owner.unbind(this.name,this.fn),this.owner=null,this.name=null,this.fn=null)},o.prototype.call=function(){this.fn&&this.fn.call(this.owner,arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7])},o.prototype.on=function(e,t){return this.owner.on(e,t)},o);function o(e,t,r){this.owner=e,this.name=t,this.fn=r}r.EventHandle=i},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.GUID=void 0;var n=(a.create=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},a);function a(){}r.GUID=n},{}],12:[function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),a(e("./events"),r),a(e("./editor"),r),a(e("./observer"),r),a(e("./tools"),r),a(e("./guid"),r),a(e("./ajax"),r),a(e("./very-light"),r),a(e("./very-camera"),r)},{"./ajax":8,"./editor":9,"./events":10,"./guid":11,"./observer":13,"./tools":14,"./very-camera":15,"./very-light":16}],13:[function(e,t,r){"use strict";var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.Observer=void 0;var i,o=e("./events"),s=(i=o.Events,a(l,i),Object.defineProperty(l.prototype,"className",{get:function(){return"Observer"},enumerable:!1,configurable:!0}),l.prototype.patchData=function(e){if("object"==typeof e)for(var t in e)"object"==typeof e[t]?this.parserObject(t,t,e[t]):(this.set(t,e[t]),this._dataType[t]=!1,this._dataType2[t]=!1);else debug.warn(this.className+": 不是正确的json对象，打印：\n"+e)},l.prototype.set=function(e,t){for(var r,n=this._data[e],a=e.split("."),i="",o=0;o<a.length-1;o++)0===o?i=a[o]:i+=this.SEPARATOR+a[o];1<a.length&&this._dataType[e]?(r=parseInt(a[a.length-1]),this._data[e]=t,this._data[i][r]=t):(this._data[e]=t,this.updateChildData(e,t),this._data2[e]=t),this.emit(e+":set",t,n),this.emit("*:set",e,t,n)},l.prototype.isNumber=function(e){var t=Number(e);return!isNaN(t)},l.prototype.updateChildData=function(e,t){if(t instanceof Array){for(var r in this._data)r.startsWith(e+this.SEPARATOR)&&(delete this._data[r],delete this._dataType[r]);for(var n,a=0;a<t.length;a++)n=e+this.SEPARATOR+a.toString(),this._data[n]=t[a],this._dataType[n]=!0}},l.prototype.unset=function(e,t){if(!this.has(e))return!1;var r=this._data[e];return delete this._data[e],delete this._dataType[e],delete this._data2[e],delete this._dataType2[e],this.emit(e+":set",t,r),this.emit("*:set",e,t,r),!0},l.prototype.insert=function(e,t,r){if(!(this.has(e)&&this._data[e]instanceof Array))return!1;var n=this._data[e];return t instanceof Array&&(t=t.slice(0)),void 0===r?(n.push(t),r=n.length-1):n.splice(r,0,t),this.updateChildData(e,n),this.emit(e+":insert",t,r),this.emit("*:insert",e,t,r),!0},l.prototype.remove=function(e,t){if(!(this.has(e)&&this._data[e]instanceof Array))return!1;var r=this._data[e];if(r.length<t)return!1;var n=r[t];return r.splice(t,1),this.updateChildData(e,r),this.emit(e+":remove",n,t),this.emit("*:remove",e,n,t),!0},l.prototype.removeValue=function(e,t){if(!(this.has(e)&&this._data[e]instanceof Array))return!1;var r=this._data[e],n=r.indexOf(t);if(-1===n)return!1;var a=r[n];return r.splice(n,1),this.updateChildData(e,r),this.emit(e+":remove",a,n),this.emit("*:remove",e,a,n),!0},l.prototype.move=function(e,t,r){if(!(this.has(e)&&this._data[e]instanceof Array))return!1;var n=this._data[e];if(n.length<t||n.length<r||t===r)return!1;var a=n[t];return n.splice(t,1),-1===r&&(r=n.length),n.splice(r,0,a),this.updateChildData(e,n),this.emit(e+":move",a,r,t),this.emit("*:move",e,a,r,t),!0},l.prototype.parserObject=function(e,t,r){var n;this.set(e,r),this._dataType[e]=!1;var a=typeof r;if("object"==a&&r instanceof Array){this._dataType2[e]=!0;for(var i=0;i<r.length;i++)n=e+this.SEPARATOR+i.toString(),this.set(n,r[i]),this._dataType[n]=!0}else if("object"==a&&r instanceof Object)for(var o in r)"object"==typeof r[o]?this.parserObject(e+this.SEPARATOR+o,o,r[o]):(n=e+this.SEPARATOR+o,this.set(n,r[o]),this._dataType[n]=!1,this._dataType2[e]=!1)},l.prototype.has=function(e){return e in this._data},l.prototype.get=function(e){return e in this._data?this._data[e]:null},l.prototype.propagate=function(i){var o=this;return function(e,t,r,n){var a;o._parent&&(!o._parentKey&&o._parentField instanceof Array&&-1===o._parentField.indexOf(o)||(o._silent&&(a=o._parent.silence()),o._parent.emit(e+":"+i,t,r,n),o._parent.emit("*:"+i,e,t,r,n),o._silent&&o._parent.silenceRestore(a)))}},l.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.emit("destroy"),this.unbind())},l);function l(e,t){var r=i.call(this)||this;if(r.SEPARATOR=".",r._dataType={},r._dataType2={},r.node=null,r.reparenting=!1,r._pathsWithDuplicates={},r.origin=e,t=t||{},r._destroyed=!1,r._path="",r._keys=[],r._data={},r._data2={},t.pathsWithDuplicates){r._pathsWithDuplicates={};for(var n=0;n<t.pathsWithDuplicates.length;n++)r._pathsWithDuplicates[t.pathsWithDuplicates[n]]=!0}return r.patchData(e),r._silent=!1,r}r.Observer=s},{"./events":10}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Tools=void 0;var n=(a.eulerAngleToRadian=function(e){var t=Math.PI/180;return e.multiplyByFloats(t,t,t)},a.radianToEulerAngle=function(e){var t=180/Math.PI;return e.multiplyByFloats(t,t,t)},a.vector3ToArray=function(e){return[e.x,e.y,e.z]},a);function a(){}r.Tools=n},{}],15:[function(e,t,r){"use strict";var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.VeryCamera=void 0;var i,o=(i=BABYLON.TransformNode,a(s,i),Object.defineProperty(s.prototype,"mode",{get:function(){return this.camera.mode},set:function(e){this.camera.mode=e},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"fov",{get:function(){return this.camera.fov},set:function(e){this.camera.fov=e},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"inertia",{get:function(){return this.camera.inertia},set:function(e){this.camera.inertia=e},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"orthoSize",{get:function(){return this.camera.mode===BABYLON.Camera.ORTHOGRAPHIC_CAMERA?(this._orthoSize=this.camera.orthoRight/this._scene.getEngine().getRenderWidth()/this.camera.viewport.width,this._orthoSize):0},set:function(e){this._orthoSize=e,this.camera.mode===BABYLON.Camera.ORTHOGRAPHIC_CAMERA&&(this.camera.orthoRight=e*this._scene.getEngine().getRenderWidth()*this.camera.viewport.width,this.camera.orthoLeft=-e*this._scene.getEngine().getRenderWidth()*this.camera.viewport.width,this.camera.orthoTop=e*this._scene.getEngine().getRenderHeight()*this.camera.viewport.height,this.camera.orthoBottom=-e*this._scene.getEngine().getRenderHeight()*this.camera.viewport.height)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"clearColor",{get:function(){return null===this._clearColor&&(this._clearColor=new BABYLON.Color4(1,1,1,1)),this._clearColor.copyFrom(this._scene.clearColor),this._clearColor},set:function(e){this._clearColor=e,this._scene.activeCameras[0]===this.camera&&e&&this._scene.clearColor.copyFrom(e)},enumerable:!1,configurable:!0}),s.prototype.renderCamera=function(e){this._render!==e&&((this._render=e)?this.camera.viewport=this._backupViewport.clone():(this._backupViewport=this.camera.viewport.clone(),this.camera.viewport=new BABYLON.Viewport(0,0,0,0)))},s.prototype.resize=function(e){var t,r;this.camera&&this._canvas&&(this._canvas.width===this._width&&this._canvas.height===this._height||(this._width=this._canvas.width,this._height=this._canvas.height,t=this._scene.getEngine().getRenderWidth(),r=this._scene.getEngine().getRenderHeight(),this.camera.mode===BABYLON.Camera.ORTHOGRAPHIC_CAMERA&&(this.camera.orthoRight=this._orthoSize*t*this.camera.viewport.width,this.camera.orthoLeft=-this._orthoSize*t*this.camera.viewport.width,this.camera.orthoTop=this._orthoSize*r*this.camera.viewport.height,this.camera.orthoBottom=-this._orthoSize*r*this.camera.viewport.height)))},s);function s(e,t,r){var n=i.call(this,e.name,t)||this;return n._orthoSize=0,n._clearColor=null,n._backupViewport=new BABYLON.Viewport(0,0,1,1),n._render=!0,(n.camera=e).name+="-Camera",n._canvas=r,n._width=r.width,n._height=r.height,n.position.copyFrom(e.position),n.rotation.copyFrom(e.rotation),e.parent=n,e.position=BABYLON.Vector3.Zero(),e.rotation=BABYLON.Vector3.Zero(),e.inputs.clear(),n}r.VeryCamera=o},{}],16:[function(e,t,r){"use strict";var n,a=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0}),r.VeryLight=void 0;var i,o=(i=BABYLON.TransformNode,a(s,i),Object.defineProperty(s.prototype,"type",{get:function(){return this.light.getTypeID()},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"intensity",{get:function(){return this.light.intensity},set:function(e){this.light.intensity=e},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"diffuse",{get:function(){return this.light.diffuse},set:function(e){this.light.diffuse=e},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"specular",{get:function(){return this.light.specular},set:function(e){this.light.specular=e},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"angle",{get:function(){return this.light instanceof BABYLON.SpotLight?this.light.angle:0},set:function(e){this.light instanceof BABYLON.SpotLight&&(this.light.angle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"exponent",{get:function(){return this.light instanceof BABYLON.SpotLight?this.light.exponent:0},set:function(e){this.light instanceof BABYLON.SpotLight&&(this.light.exponent=e)},enumerable:!1,configurable:!0}),s);function s(e,t){var r=i.call(this,e.name,t)||this;return e.name+="-Light",r.light=e,r.position.copyFrom(e.getAbsolutePosition()),e.parent=r}r.VeryLight=o},{}],17:[function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0});var i=e("./game"),o=e("./lib");a(e("./index"),r);var s,l=!1,c=!1;window.editor=new o.Editor;var u;window.location.pathname.substring(9);u=window.location.pathname.substring(9),i.Config.projectID=u,axios.post("/api/getProject",{projectID:i.Config.projectID}).then(function(e){var t=e.data;"0000"===t.code?(i.Config.projectData=t.data,i.Config.projectName=t.data.project.name,i.Config.userID=t.data.owner.id,i.Config.username=t.data.owner.username,editor.call("getAssets")):console.error("load project data error: "+t.message)}).catch(function(e){console.error("load project data error: "),console.error(e)}),editor.method("getAssets",function(){axios.post("/api/getAssets",{projectID:i.Config.projectID}).then(function(e){var t=e.data;if("0000"===t.code){if(i.Config.assetsData=t.data,i.BabylonLoader.assetsData=t.data,editor.call("getScenes"),t.data.assets)for(var r in t.data.assets)"table"===t.data.assets[r].type&&(i.Config.tableAssetsID=r,i.Config.tableName=t.data.assets[r].name);""!==i.Config.tableAssetsID?editor.call("loadTable"):l=!0}else console.error(t.message)}).catch(function(e){console.error(e)})}),editor.method("getScenes",function(){axios.post("/api/getScenes",{projectID:i.Config.projectID}).then(function(e){var t,r=e.data;"0000"===r.code?(t=r.data.last,i.Config.scenesData=r.data.scenes[t],i.Config.sceneIndex=t,i.Config.sceneName=i.Config.scenesData.name,document.title=i.Config.projectName+" - "+i.Config.sceneName+" - 万维引擎",c=!0):console.error(r.message)}).catch(function(e){console.error(e)})}),editor.method("loadTable",function(){window.location.href;var e={};e.name=i.Config.tableName,e.projectID=u,e.id=i.Config.tableAssetsID,axios.get("/api/table/acquire",{params:e}).then(function(e){var t,r=e.data;"0000"===r.code?(t=function(e){var t=document.createElement("div");t.innerHTML=e;var r=t.innerText||t.textContent;return t=null,r}(t=JSON.stringify(r.data)),s=JSON.parse(t).table,i.Config.tableData=s,l=!0):console.log("load not right: "+r.message)}).catch(function(e){console.log("load error: "+e)})}),function e(){var t,r;l&&c?(t=document.getElementById("renderCanvas"),(r=document.getElementById("fpsLabel")).style.display="none",null!==t&&null!==r&&new i.Game(t,r).createScene(s).animate()):setTimeout(e,500)}()},{"./game":4,"./index":7,"./lib":12}]},{},[17]);
//# sourceMappingURL=publish.js.map
